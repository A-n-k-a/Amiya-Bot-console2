"use strict";(self["webpackChunkamiyabot_console"]=self["webpackChunkamiyabot_console"]||[]).push([[850],{556:function(e,t,a){a.d(t,{E5:function(){return i},Yq:function(){return r},jQ:function(){return n},m7:function(){return c}});var l=a(8199);const o=new l.Z;async function i(){return await o.get({url:"/operator/getAllOperator"})}async function n(e){return await o.post({url:"/operator/getOperator",data:e})}async function r(e){return await o.post({url:"/operator/setOperator",data:e})}async function c(){return await o.get({url:"/operator/updateSetting"})}},8288:function(e,t,a){a.d(t,{Z:function(){return Z}});var l=a(1015),o=(a(8474),a(3191)),i=(a(1758),a(3877),a(4550)),n=(a(6905),a(9007),a(3417)),r=(a(172),a(2261)),c=(a(6809),a(3396));const u={class:"v-table"},s={class:"header-area"},p=["innerHTML"],d=["innerHTML"],f={class:"v-bottom"};function h(e,t,a,h,m,g){const w=r.mi,k=n.EZ,_=i.$Y,y=i.eI,b=o.R,v=(0,c.up)("Refresh"),W=l.gn;return(0,c.wg)(),(0,c.iD)("div",u,[(0,c._)("div",s,[(0,c._)("div",null,[(0,c.WI)(e.$slots,"header")]),(0,c.Wm)(k,{style:{width:"520px"},modelValue:e.searchInput,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchInput=t),placeholder:"输入任意值搜索...",onChange:t[1]||(t[1]=t=>e.executeLoad(!0))},{append:(0,c.w5)((()=>[(0,c.Wm)(w,{icon:e.searchIcon},null,8,["icon"])])),_:1},8,["modelValue"])]),(0,c.Wm)(y,{data:e.tableData,stripe:"","header-cell-class-name":"v-table-header",ref:"table","empty-text":"暂无数据","max-height":600},{default:(0,c.w5)((()=>[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(e.columns,((t,a)=>((0,c.wg)(),(0,c.j4)(_,{"show-overflow-tooltip":"",width:t.width||e.colWidth[t.field],"class-name":"mark_"+t.field,key:a,prop:t.field,label:t.title},{default:(0,c.w5)((a=>[(0,c.WI)(e.$slots,"cell",{row:a.row,field:t.field,value:a.row[t.field],index:a.$index},(()=>[t.format?((0,c.wg)(),(0,c.iD)("div",{key:0,innerHTML:t.format(a.row,a.row[t.field],a.$index)},null,8,p)):((0,c.wg)(),(0,c.iD)("div",{key:1,innerHTML:a.row[t.field]},null,8,d))]))])),_:2},1032,["width","class-name","prop","label"])))),128)),this.$slots.operations?((0,c.wg)(),(0,c.j4)(_,{key:0,label:"操作",fixed:"right","class-name":"mark_operation",width:e.colWidth.operation},{default:(0,c.w5)((t=>[(0,c.WI)(e.$slots,"operations",{row:t.row,index:t.$index})])),_:3},8,["width"])):(0,c.kq)("",!0)])),_:3},8,["data"]),(0,c._)("div",f,[(0,c.Wm)(b,{layout:e.pagination?"total, prev, pager, next, sizes, jumper":"total",small:!0,background:!0,currentPage:e.currentPage,"onUpdate:currentPage":t[2]||(t[2]=t=>e.currentPage=t),"page-size":e.pageSize,"onUpdate:page-size":t[3]||(t[3]=t=>e.pageSize=t),total:e.total,"onUpdate:total":t[4]||(t[4]=t=>e.total=t),onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["layout","currentPage","page-size","total","onSizeChange","onCurrentChange"]),(0,c.Wm)(W,{class:"v-bottom-icon",size:20,onClick:t[5]||(t[5]=t=>e.executeLoad())},{default:(0,c.w5)((()=>[(0,c.Wm)(v)])),_:1})])])}var m=a(2482),g=a(4870),w=a(6520);function k(e,t=50){const a=e.clientWidth,l={};let o=0;if(0===a)return{};const i=e.querySelectorAll("tr");i.forEach((e=>{e.querySelectorAll("td, th").forEach((e=>{const a=e.querySelector(".cell"),o=e.querySelectorAll(".cell > *"),i=e.className.match(/mark_(\S+)/);let n=t;for(const t of o)n+=t.offsetWidth;if(i){const e=i[1];"operation"===e&&(n+=30),e in l?l[e]<n&&(l[e]=n):l[e]=a?.offsetWidth||0}}))}));for(const n in l)o+=l[n];if(o<a){let e=Object.keys(l).length;"selection"in l&&(e-=1),"operation"in l&&(e-=1);const t=(a-o)/e;for(const a in l)"selection"!==a&&"operation"!==a&&(l[a]+=t)}return l}var _=a(2748),y=function(e,t,a,l){var o,i=arguments.length,n=i<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,a):l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(e,t,a,l);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(n=(i<3?o(n):i>3?o(t,a,n):o(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n};let b=class extends w.w3{constructor(...e){super(...e),(0,m.Z)(this,"load",void 0),(0,m.Z)(this,"searchIcon",(0,g.XI)(_.olm)),(0,m.Z)(this,"searchInput",""),(0,m.Z)(this,"tableData",[]),(0,m.Z)(this,"columns",[]),(0,m.Z)(this,"colWidth",{}),(0,m.Z)(this,"pagination",!1),(0,m.Z)(this,"currentPage",1),(0,m.Z)(this,"pageSize",10),(0,m.Z)(this,"total",0)}getColumns(){return{columns:this.columns,colWidth:this.colWidth}}setData(e){this.tableData=e,this.total=e.length,this.pagination=!1}setPaginationData(e){this.tableData=e.list,this.total=e.total,this.pagination=!0}setColumns(e){const t=[];for(const a in e){const l=e[a];l.constructor===String?t.push({field:a,title:l}):(l.field||(l.field=a),t.push(l))}this.columns=t,this.executeLoad()}executeLoad(e=!1){e&&(this.currentPage=1),this.load({currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchInput})}handleSizeChange(){this.executeLoad()}handleCurrentChange(){this.executeLoad()}};b=y([(0,w.Ei)({components:{Refresh:_.hYj},props:{load:{type:Function,default:()=>null}},computed:{table(){return this.$refs.table}},methods:{resetWidth(){setTimeout((()=>{this.colWidth=k(this.table.$el)}),200)}},watch:{tableData:{handler(){this.resetWidth()},deep:!0}}})],b);var v=b,W=a(89);const C=(0,W.Z)(v,[["render",h]]);var Z=C},5860:function(e,t,a){a.d(t,{Z:function(){return h}});var l=a(7947),o=(a(9910),a(1955)),i=(a(2064),a(3396));function n(e,t,a,n,r,c){const u=o.ly,s=l.d0;return(0,i.wg)(),(0,i.j4)(s,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialogVisible=t),title:e.title,"append-to-body":e.appendToBody,width:e.width},{footer:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"footer")])),default:(0,i.w5)((()=>[(0,i.Wm)(u,{model:e.form,"label-width":e.labelWidth},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3},8,["model","label-width"])])),_:3},8,["modelValue","title","append-to-body","width"])}var r=a(2482),c=a(6520),u=function(e,t,a,l){var o,i=arguments.length,n=i<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,a):l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(e,t,a,l);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(n=(i<3?o(n):i>3?o(t,a,n):o(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n};let s=class extends c.w3{constructor(...e){super(...e),(0,r.Z)(this,"form",void 0),(0,r.Z)(this,"title",void 0),(0,r.Z)(this,"dialogVisible",!1)}show(){this.dialogVisible=!0}async asyncShow(){this.dialogVisible=!0,await this.$nextTick()}hide(){this.dialogVisible=!1}async asyncHide(){this.dialogVisible=!1,await this.$nextTick()}};s=u([(0,c.Ei)({props:{form:Object,title:String,width:Number,appendToBody:Boolean,labelWidth:{type:String,default:()=>"100px"}}})],s);var p=s,d=a(89);const f=(0,d.Z)(p,[["render",n]]);var h=f},5850:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var l=a(5860),o=a(9667),i=(a(9112),a(8655)),n=(a(3877),a(7960),a(1955)),r=(a(7113),a(3417)),c=(a(172),a(8288)),u=a(5065),s=(a(3189),a(9971)),p=(a(1430),a(2261)),d=(a(6809),a(3396)),f=a(7139);const h=(0,d.Uk)("添加卡池"),m=(0,d.Uk)("同步卡池"),g=(0,d.Uk)("普通卡池"),w=(0,d.Uk)("限定卡池"),k=(0,d.Uk)("联合寻访"),_=(0,d.Uk)("前路回响"),y=(0,d.Uk)("中坚寻访"),b=(0,d.Uk)("修改"),v=(0,d.Uk)("删除"),W=(0,d.Uk)("+ 添加权值"),C=(0,d.Uk)("确定"),Z=(0,d.Uk)("保存");function D(e,t,a,D,V,j){const x=p.mi,P=s.Ks,U=u.E2,S=c.Z,$=r.EZ,L=n.nH,z=i.BT,O=i.km,H=o.d6,I=l.Z;return(0,d.wg)(),(0,d.iD)("div",null,[(0,d.Wm)(S,{ref:"table",load:e.loadList},{header:(0,d.w5)((()=>[(0,d.Wm)(x,{type:"primary",onClick:e.addPool},{default:(0,d.w5)((()=>[h])),_:1},8,["onClick"]),(0,d.Wm)(x,{type:"warning",onClick:e.syncPool},{default:(0,d.w5)((()=>[m])),_:1},8,["onClick"])])),cell:(0,d.w5)((({value:t,field:a})=>[["pickup_6","pickup_5","pickup_4","pickup_s"].indexOf(a)>=0?((0,d.wg)(!0),(0,d.iD)(d.HY,{key:0},(0,d.Ko)((t||"").split(","),((t,l)=>((0,d.wg)(),(0,d.iD)(d.HY,null,[t?((0,d.wg)(),(0,d.j4)(P,{key:l,effect:"plain",type:e.tagColor[a],style:{"margin-right":"3px"}},{default:(0,d.w5)((()=>[(0,d.Uk)((0,f.zw)(t.replace("|"," x ")),1)])),_:2},1032,["type"])):(0,d.kq)("",!0)],64)))),256)):(0,d.kq)("",!0),"limit_pool"===a?((0,d.wg)(),(0,d.iD)(d.HY,{key:1},[0===t?((0,d.wg)(),(0,d.j4)(P,{key:0,effect:"light"},{default:(0,d.w5)((()=>[g])),_:1})):1===t?((0,d.wg)(),(0,d.j4)(P,{key:1,effect:"dark",type:"danger"},{default:(0,d.w5)((()=>[w])),_:1})):2===t?((0,d.wg)(),(0,d.j4)(P,{key:2,effect:"dark",type:"success"},{default:(0,d.w5)((()=>[k])),_:1})):3===t?((0,d.wg)(),(0,d.j4)(P,{key:3,effect:"dark",type:"warning"},{default:(0,d.w5)((()=>[_])),_:1})):4===t?((0,d.wg)(),(0,d.j4)(P,{key:4,effect:"light",type:"info"},{default:(0,d.w5)((()=>[y])),_:1})):(0,d.kq)("",!0)],64)):(0,d.kq)("",!0)])),operations:(0,d.w5)((({row:t})=>[(0,d.Wm)(U,{underline:!1,type:"primary",onClick:a=>e.updateGacha(t)},{default:(0,d.w5)((()=>[b])),_:2},1032,["onClick"]),(0,d.Wm)(U,{underline:!1,type:"danger",onClick:a=>e.delGacha(t)},{default:(0,d.w5)((()=>[v])),_:2},1032,["onClick"])])),_:1},8,["load"]),(0,d.Wm)(I,{title:"编辑卡池",form:e.form,ref:"dialog","append-to-body":!0},{footer:(0,d.w5)((()=>[(0,d.Wm)(x,{type:"primary",onClick:e.submit},{default:(0,d.w5)((()=>[Z])),_:1},8,["onClick"])])),default:(0,d.w5)((()=>[(0,d.Wm)(L,{label:"卡池名称"},{default:(0,d.w5)((()=>[(0,d.Wm)($,{modelValue:e.form.pool_name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.pool_name=t),placeholder:"请输入卡池名称"},null,8,["modelValue"])])),_:1}),(0,d.Wm)(L,{label:"卡池属性"},{default:(0,d.w5)((()=>[(0,d.Wm)(O,{style:{width:"100%"},modelValue:e.form.limit_pool,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.limit_pool=t),placeholder:"请选择卡池属性"},{default:(0,d.w5)((()=>[(0,d.Wm)(z,{label:"普通卡池",value:0}),(0,d.Wm)(z,{label:"限定卡池",value:1}),(0,d.Wm)(z,{label:"联合寻访",value:2}),(0,d.Wm)(z,{label:"前路回响",value:3}),(0,d.Wm)(z,{label:"中坚寻访",value:4})])),_:1},8,["modelValue"])])),_:1}),((0,d.wg)(),(0,d.iD)(d.HY,null,(0,d.Ko)({r6:"pickup_6",r5:"pickup_5",r4:"pickup_4"},((t,a)=>(0,d.Wm)(L,{key:t,label:a[1]+"星概率提升"},{default:(0,d.w5)((()=>[(0,d.Wm)(O,{style:{width:"100%"},modelValue:e.form[t],"onUpdate:modelValue":a=>e.form[t]=a,multiple:"",filterable:"",placeholder:`请选择${a[1]}星概率提升的干员`},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.operatorList,((e,t)=>((0,d.wg)(),(0,d.iD)(d.HY,null,[e.rarity===a[1].toString()?((0,d.wg)(),(0,d.j4)(z,{label:e.name,value:e.name,key:t},null,8,["label","value"])):(0,d.kq)("",!0)],64)))),256))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label"]))),64)),(0,d.Wm)(L,{label:"权值",placeholder:"输入权值（可选）"},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.form.pickup_s,((e,t)=>((0,d.wg)(),(0,d.j4)(P,{style:{"margin-right":"3px"},key:t,effect:"plain"},{default:(0,d.w5)((()=>[(0,d.Uk)((0,f.zw)(e.replace("|"," x ")),1)])),_:2},1024)))),128)),(0,d.Wm)(x,{size:"small",onClick:t[2]||(t[2]=t=>e.innerDialog.show())},{default:(0,d.w5)((()=>[W])),_:1})])),_:1}),(0,d.Wm)(I,{title:"添加权值",form:e.innerForm,ref:"innerDialog",width:400},{footer:(0,d.w5)((()=>[(0,d.Wm)(x,{type:"primary",onClick:e.setPickupS},{default:(0,d.w5)((()=>[C])),_:1},8,["onClick"])])),default:(0,d.w5)((()=>[(0,d.Wm)(L,{label:"加权干员"},{default:(0,d.w5)((()=>[(0,d.Wm)(O,{style:{width:"100%"},modelValue:e.innerForm.name,"onUpdate:modelValue":t[3]||(t[3]=t=>e.innerForm.name=t),placeholder:"请选择加权干员"},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.operatorList,((e,t)=>((0,d.wg)(),(0,d.iD)(d.HY,null,["6"===e.rarity?((0,d.wg)(),(0,d.j4)(z,{label:e.name,value:e.name,key:t},null,8,["label","value"])):(0,d.kq)("",!0)],64)))),256))])),_:1},8,["modelValue"])])),_:1}),(0,d.Wm)(L,{label:"权重值",placeholder:"输入权重值"},{default:(0,d.w5)((()=>[(0,d.Wm)(H,{modelValue:e.innerForm.num,"onUpdate:modelValue":t[4]||(t[4]=t=>e.innerForm.num=t)},null,8,["modelValue"])])),_:1})])),_:1},8,["form"])])),_:1},8,["form"])])}var V=a(2482),j=a(6520),x=a(8199);const P=new x.Z;async function U(e){return await P.post({url:"/gacha/getPool",data:e})}async function S(e){return await P.post({url:e.id?"/gacha/updatePool":"/gacha/addPool",data:e})}async function $(e){return await P.post({url:"/gacha/deletePool",data:e})}async function L(){return await P.get({url:"/gacha/syncPool"})}var z=a(556),O=a(9037),H=a(8418),I=function(e,t,a,l){var o,i=arguments.length,n=i<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,a):l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(e,t,a,l);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(n=(i<3?o(n):i>3?o(t,a,n):o(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n};let Y=class extends j.w3{constructor(...e){super(...e),(0,V.Z)(this,"table",void 0),(0,V.Z)(this,"dialog",void 0),(0,V.Z)(this,"innerDialog",void 0),(0,V.Z)(this,"form",{pool_name:"",limit_pool:"",pickup_6:[],pickup_5:[],pickup_4:[],pickup_s:[]}),(0,V.Z)(this,"innerForm",{name:"",num:5}),(0,V.Z)(this,"tagColor",{pickup_6:"danger",pickup_5:"warning",pickup_4:"info",pickup_s:""}),(0,V.Z)(this,"operatorList",[])}async loadList(e){const t=await U(e);t&&this.table.setPaginationData(t.data)}async getAllOperator(){const e=await(0,z.E5)();e&&(this.operatorList=e.data)}addPool(){this.form={pool_name:"",limit_pool:"",pickup_6:[],pickup_5:[],pickup_4:[],pickup_s:[]},this.dialog.show()}updateGacha(e){const t=H.Z.deepCopy(e);t.pickup_6=e.pickup_6?e.pickup_6.split(","):[],t.pickup_5=e.pickup_5?e.pickup_5.split(","):[],t.pickup_4=e.pickup_4?e.pickup_4.split(","):[],t.pickup_s=e.pickup_s?e.pickup_s.split(","):[],this.form=t,this.dialog.show()}async delGacha(e){const t=await $(e);t&&this.table.executeLoad()}async submit(){const e=H.Z.deepCopy(this.form);e.pickup_6=e.pickup_6.join(","),e.pickup_5=e.pickup_5.join(","),e.pickup_4=e.pickup_4.join(","),e.pickup_s=e.pickup_s.join(",");const t=await S(e);t&&(this.dialog.hide(),this.table.executeLoad())}async syncPool(){if(await O.Z.confirm("同步卡池将会强制覆盖本地所有卡池配置，造成自定义的卡池丢失，是否开始同步？","警告")){const e=await L();e&&this.table.executeLoad(!0)}}setPickupS(){this.form.pickup_s.push(`${this.innerForm.name}|${this.innerForm.num}`),this.innerDialog.hide()}};Y=I([(0,j.Ei)({components:{VTable:c.Z,VFormDialog:l.Z},computed:{table(){return this.$refs.table},dialog(){return this.$refs.dialog},innerDialog(){return this.$refs.innerDialog}},mounted(){this.table.setColumns({pool_name:"卡池名称",limit_pool:"卡池属性",pickup_6:"6星概率提升",pickup_5:"5星概率提升",pickup_4:"4星概率提升",pickup_s:"权值"}),this.getAllOperator()}})],Y);var q=Y,R=a(89);const T=(0,R.Z)(q,[["render",D]]);var E=T},88:function(e,t,a){a(1758)},9910:function(e,t,a){a(1758),a(7195)},9112:function(e,t,a){a(1758),a(172)},3189:function(e,t,a){a(1758)},7960:function(e,t,a){a(1758)},7195:function(e,t,a){a(1758)},6467:function(e,t,a){a(1758)},451:function(e,t,a){a(1758)},3877:function(e,t,a){a(1758),a(172),a(1430),a(7960),a(451),a(6467)},9007:function(e,t,a){a(1758),a(88),a(1430)},6905:function(e,t,a){a(1758),a(88),a(1430),a(4566),a(451)},4566:function(e,t,a){a(1758),a(6467)}}]);
//# sourceMappingURL=850.287638ba.js.map