"use strict";(self["webpackChunkamiyabot_console"]=self["webpackChunkamiyabot_console"]||[]).push([[108],{556:function(e,t,o){o.d(t,{E5:function(){return l},Yq:function(){return r},jQ:function(){return i},m7:function(){return s}});var a=o(8199);const n=new a.Z;async function l(){return await n.get({url:"/operator/getAllOperator"})}async function i(e){return await n.post({url:"/operator/getOperator",data:e})}async function r(e){return await n.post({url:"/operator/setOperator",data:e})}async function s(){return await n.get({url:"/operator/updateSetting"})}},8288:function(e,t,o){o.d(t,{Z:function(){return C}});var a=o(1015),n=(o(8474),o(3191)),l=(o(1758),o(3877),o(4550)),i=(o(6905),o(9007),o(3417)),r=(o(172),o(2261)),s=(o(6809),o(3396));const c={class:"v-table"},d={class:"header-area"},u=["innerHTML"],h=["innerHTML"],f={class:"v-bottom"};function p(e,t,o,p,m,g){const w=r.mi,b=i.EZ,y=l.$Y,v=l.eI,W=n.R,_=(0,s.up)("Refresh"),k=a.gn;return(0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",d,[(0,s._)("div",null,[(0,s.WI)(e.$slots,"header")]),(0,s.Wm)(b,{style:{width:"520px"},modelValue:e.searchInput,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchInput=t),placeholder:"输入任意值搜索...",onChange:t[1]||(t[1]=t=>e.executeLoad(!0))},{append:(0,s.w5)((()=>[(0,s.Wm)(w,{icon:e.searchIcon},null,8,["icon"])])),_:1},8,["modelValue"])]),(0,s.Wm)(v,{data:e.tableData,stripe:"","header-cell-class-name":"v-table-header",ref:"table","empty-text":"暂无数据","max-height":600},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.columns,((t,o)=>((0,s.wg)(),(0,s.j4)(y,{"show-overflow-tooltip":"",width:t.width||e.colWidth[t.field],"class-name":"mark_"+t.field,key:o,prop:t.field,label:t.title},{default:(0,s.w5)((o=>[(0,s.WI)(e.$slots,"cell",{row:o.row,field:t.field,value:o.row[t.field],index:o.$index},(()=>[t.format?((0,s.wg)(),(0,s.iD)("div",{key:0,innerHTML:t.format(o.row,o.row[t.field],o.$index)},null,8,u)):((0,s.wg)(),(0,s.iD)("div",{key:1,innerHTML:o.row[t.field]},null,8,h))]))])),_:2},1032,["width","class-name","prop","label"])))),128)),this.$slots.operations?((0,s.wg)(),(0,s.j4)(y,{key:0,label:"操作",fixed:"right","class-name":"mark_operation",width:e.colWidth.operation},{default:(0,s.w5)((t=>[(0,s.WI)(e.$slots,"operations",{row:t.row,index:t.$index})])),_:3},8,["width"])):(0,s.kq)("",!0)])),_:3},8,["data"]),(0,s._)("div",f,[(0,s.Wm)(W,{layout:e.pagination?"total, prev, pager, next, sizes, jumper":"total",small:!0,background:!0,currentPage:e.currentPage,"onUpdate:currentPage":t[2]||(t[2]=t=>e.currentPage=t),"page-size":e.pageSize,"onUpdate:page-size":t[3]||(t[3]=t=>e.pageSize=t),total:e.total,"onUpdate:total":t[4]||(t[4]=t=>e.total=t),onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["layout","currentPage","page-size","total","onSizeChange","onCurrentChange"]),(0,s.Wm)(k,{class:"v-bottom-icon",size:20,onClick:t[5]||(t[5]=t=>e.executeLoad())},{default:(0,s.w5)((()=>[(0,s.Wm)(_)])),_:1})])])}var m=o(2482),g=o(4870),w=o(6520);function b(e,t=50){const o=e.clientWidth,a={};let n=0;if(0===o)return{};const l=e.querySelectorAll("tr");l.forEach((e=>{e.querySelectorAll("td, th").forEach((e=>{const o=e.querySelector(".cell"),n=e.querySelectorAll(".cell > *"),l=e.className.match(/mark_(\S+)/);let i=t;for(const t of n)i+=t.offsetWidth;if(l){const e=l[1];"operation"===e&&(i+=30),e in a?a[e]<i&&(a[e]=i):a[e]=o?.offsetWidth||0}}))}));for(const i in a)n+=a[i];if(n<o){let e=Object.keys(a).length;"selection"in a&&(e-=1),"operation"in a&&(e-=1);const t=(o-n)/e;for(const o in a)"selection"!==o&&"operation"!==o&&(a[o]+=t)}return a}var y=o(2748),v=function(e,t,o,a){var n,l=arguments.length,i=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(i=(l<3?n(i):l>3?n(t,o,i):n(t,o))||i);return l>3&&i&&Object.defineProperty(t,o,i),i};let W=class extends w.w3{constructor(...e){super(...e),(0,m.Z)(this,"load",void 0),(0,m.Z)(this,"searchIcon",(0,g.XI)(y.olm)),(0,m.Z)(this,"searchInput",""),(0,m.Z)(this,"tableData",[]),(0,m.Z)(this,"columns",[]),(0,m.Z)(this,"colWidth",{}),(0,m.Z)(this,"pagination",!1),(0,m.Z)(this,"currentPage",1),(0,m.Z)(this,"pageSize",10),(0,m.Z)(this,"total",0)}getColumns(){return{columns:this.columns,colWidth:this.colWidth}}setData(e){this.tableData=e,this.total=e.length,this.pagination=!1}setPaginationData(e){this.tableData=e.list,this.total=e.total,this.pagination=!0}setColumns(e){const t=[];for(const o in e){const a=e[o];a.constructor===String?t.push({field:o,title:a}):(a.field||(a.field=o),t.push(a))}this.columns=t,this.executeLoad()}executeLoad(e=!1){e&&(this.currentPage=1),this.load({currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchInput})}handleSizeChange(){this.executeLoad()}handleCurrentChange(){this.executeLoad()}};W=v([(0,w.Ei)({components:{Refresh:y.hYj},props:{load:{type:Function,default:()=>null}},computed:{table(){return this.$refs.table}},methods:{resetWidth(){setTimeout((()=>{this.colWidth=b(this.table.$el)}),200)}},watch:{tableData:{handler(){this.resetWidth()},deep:!0}}})],W);var _=W,k=o(89);const Z=(0,k.Z)(_,[["render",p]]);var C=Z},5860:function(e,t,o){o.d(t,{Z:function(){return p}});var a=o(7947),n=(o(9910),o(1955)),l=(o(2064),o(3396));function i(e,t,o,i,r,s){const c=n.ly,d=a.d0;return(0,l.wg)(),(0,l.j4)(d,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialogVisible=t),title:e.title,"append-to-body":e.appendToBody,width:e.width},{footer:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"footer")])),default:(0,l.w5)((()=>[(0,l.Wm)(c,{model:e.form,"label-width":e.labelWidth},{default:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"default")])),_:3},8,["model","label-width"])])),_:3},8,["modelValue","title","append-to-body","width"])}var r=o(2482),s=o(6520),c=function(e,t,o,a){var n,l=arguments.length,i=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(i=(l<3?n(i):l>3?n(t,o,i):n(t,o))||i);return l>3&&i&&Object.defineProperty(t,o,i),i};let d=class extends s.w3{constructor(...e){super(...e),(0,r.Z)(this,"form",void 0),(0,r.Z)(this,"title",void 0),(0,r.Z)(this,"dialogVisible",!1)}show(){this.dialogVisible=!0}async asyncShow(){this.dialogVisible=!0,await this.$nextTick()}hide(){this.dialogVisible=!1}async asyncHide(){this.dialogVisible=!1,await this.$nextTick()}};d=c([(0,s.Ei)({props:{form:Object,title:String,width:Number,appendToBody:Boolean,labelWidth:{type:String,default:()=>"100px"}}})],d);var u=d,h=o(89);const f=(0,h.Z)(u,[["render",i]]);var p=f},7108:function(e,t,o){o.r(t),o.d(t,{default:function(){return C}});var a=o(5860),n=o(8655),l=(o(3877),o(7960),o(1955)),i=(o(7113),o(3417)),r=(o(172),o(8288)),s=o(5065),c=(o(3189),o(2261)),d=(o(6809),o(3396)),u=o(7139);const h=(0,d.Uk)("应用干员设置"),f=(0,d.Uk)("设定干员属性"),p=(0,d.Uk)("保存");function m(e,t,o,m,g,w){const b=c.mi,y=s.E2,v=r.Z,W=i.EZ,_=l.nH,k=n.BT,Z=n.km,C=a.Z;return(0,d.wg)(),(0,d.iD)("div",null,[(0,d.Wm)(v,{ref:"table",load:e.loadList},{header:(0,d.w5)((()=>[(0,d.Wm)(b,{type:"success",onClick:e.updateSetting},{default:(0,d.w5)((()=>[h])),_:1},8,["onClick"])])),operations:(0,d.w5)((({row:t})=>[(0,d.Wm)(y,{underline:!1,type:"primary",onClick:o=>e.setOperator(t)},{default:(0,d.w5)((()=>[f])),_:2},1032,["onClick"])])),cell:(0,d.w5)((({value:t,field:o})=>["operator_type"===o?((0,d.wg)(),(0,d.iD)(d.HY,{key:0},[(0,d.Uk)((0,u.zw)(e.operatorType[t]||"无"),1)],64)):(0,d.kq)("",!0)])),_:1},8,["load"]),(0,d.Wm)(C,{title:"编辑干员",form:e.form,ref:"dialog"},{footer:(0,d.w5)((()=>[(0,d.Wm)(b,{type:"primary",onClick:e.submit},{default:(0,d.w5)((()=>[p])),_:1},8,["onClick"])])),default:(0,d.w5)((()=>[(0,d.Wm)(_,{label:"干员代号"},{default:(0,d.w5)((()=>[(0,d.Wm)(W,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.name=t),disabled:""},null,8,["modelValue"])])),_:1}),(0,d.Wm)(_,{label:"干员英文代号"},{default:(0,d.w5)((()=>[(0,d.Wm)(W,{modelValue:e.form.en_name,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.en_name=t),disabled:""},null,8,["modelValue"])])),_:1}),(0,d.Wm)(_,{label:"卡池属性"},{default:(0,d.w5)((()=>[(0,d.Wm)(Z,{modelValue:e.form.operator_type,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.operator_type=t),placeholder:"请选择卡池属性"},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.operatorType,((e,t)=>((0,d.wg)(),(0,d.j4)(k,{label:e,value:t,key:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["form"])])}var g=o(2482),w=o(6520),b=o(556),y=o(8418),v=function(e,t,o,a){var n,l=arguments.length,i=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(i=(l<3?n(i):l>3?n(t,o,i):n(t,o))||i);return l>3&&i&&Object.defineProperty(t,o,i),i};let W=class extends w.w3{constructor(...e){super(...e),(0,g.Z)(this,"table",void 0),(0,g.Z)(this,"dialog",void 0),(0,g.Z)(this,"form",{}),(0,g.Z)(this,"operatorType",{0:"可抽取-限定干员",1:"可抽取-联动干员",2:"不可抽取-非常规途径",3:"不可抽取-销售",4:"不可抽取-公开招募",5:"不可抽取-活动奖励",6:"不可抽取-联动奖励",7:"不可抽取-危机合约奖励",8:"不可抽取-roguelike限定"})}async loadList(e){const t=await(0,b.jQ)(e);t&&this.table.setPaginationData(t.data)}async setOperator(e){const t=y.Z.deepCopy(e);t.operator_type=(t.operator_type||"").toString(),this.form=t,this.dialog.show()}async submit(){const e=await(0,b.Yq)(this.form);e&&(this.dialog.hide(),this.table.executeLoad())}async updateSetting(){await(0,b.m7)()}};W=v([(0,w.Ei)({components:{VTable:r.Z,VFormDialog:a.Z},computed:{table(){return this.$refs.table},dialog(){return this.$refs.dialog}},mounted(){this.table.setColumns({name:"干员代号",en_name:"干员英文代号",rarity:"星级",classes:"职业",classes_sub:"分支职业",operator_type:"卡池属性"})}})],W);var _=W,k=o(89);const Z=(0,k.Z)(_,[["render",m]]);var C=Z},88:function(e,t,o){o(1758)},9910:function(e,t,o){o(1758),o(7195)},3189:function(e,t,o){o(1758)},7960:function(e,t,o){o(1758)},7195:function(e,t,o){o(1758)},6467:function(e,t,o){o(1758)},451:function(e,t,o){o(1758)},3877:function(e,t,o){o(1758),o(172),o(1430),o(7960),o(451),o(6467)},9007:function(e,t,o){o(1758),o(88),o(1430)},6905:function(e,t,o){o(1758),o(88),o(1430),o(4566),o(451)},4566:function(e,t,o){o(1758),o(6467)}}]);
//# sourceMappingURL=108.0414420e.js.map