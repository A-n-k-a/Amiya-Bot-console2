"use strict";(self["webpackChunkamiyabot_console"]=self["webpackChunkamiyabot_console"]||[]).push([[380],{8288:function(e,t,o){o.d(t,{Z:function(){return Z}});var a=o(1015),l=(o(8474),o(3191)),n=(o(1758),o(3877),o(4550)),i=(o(6905),o(9007),o(3417)),r=(o(172),o(2261)),s=(o(6809),o(3396));const d={class:"v-table"},c={class:"header-area"},u=["innerHTML"],f=["innerHTML"],h={class:"v-bottom"};function m(e,t,o,m,p,g){const w=r.mi,b=i.EZ,y=n.$Y,v=n.eI,W=l.R,_=(0,s.up)("Refresh"),k=a.gn;return(0,s.wg)(),(0,s.iD)("div",d,[(0,s._)("div",c,[(0,s._)("div",null,[(0,s.WI)(e.$slots,"header")]),(0,s.Wm)(b,{style:{width:"520px"},modelValue:e.searchInput,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchInput=t),placeholder:"输入任意值搜索...",onChange:t[1]||(t[1]=t=>e.executeLoad(!0))},{append:(0,s.w5)((()=>[(0,s.Wm)(w,{icon:e.searchIcon},null,8,["icon"])])),_:1},8,["modelValue"])]),(0,s.Wm)(v,{data:e.tableData,stripe:"","header-cell-class-name":"v-table-header",ref:"table","empty-text":"暂无数据","max-height":600},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.columns,((t,o)=>((0,s.wg)(),(0,s.j4)(y,{"show-overflow-tooltip":"",width:t.width||e.colWidth[t.field],"class-name":"mark_"+t.field,key:o,prop:t.field,label:t.title},{default:(0,s.w5)((o=>[(0,s.WI)(e.$slots,"cell",{row:o.row,field:t.field,value:o.row[t.field],index:o.$index},(()=>[t.format?((0,s.wg)(),(0,s.iD)("div",{key:0,innerHTML:t.format(o.row,o.row[t.field],o.$index)},null,8,u)):((0,s.wg)(),(0,s.iD)("div",{key:1,innerHTML:o.row[t.field]},null,8,f))]))])),_:2},1032,["width","class-name","prop","label"])))),128)),this.$slots.operations?((0,s.wg)(),(0,s.j4)(y,{key:0,label:"操作",fixed:"right","class-name":"mark_operation",width:e.colWidth.operation},{default:(0,s.w5)((t=>[(0,s.WI)(e.$slots,"operations",{row:t.row,index:t.$index})])),_:3},8,["width"])):(0,s.kq)("",!0)])),_:3},8,["data"]),(0,s._)("div",h,[(0,s.Wm)(W,{layout:e.pagination?"total, prev, pager, next, sizes, jumper":"total",small:!0,background:!0,currentPage:e.currentPage,"onUpdate:currentPage":t[2]||(t[2]=t=>e.currentPage=t),"page-size":e.pageSize,"onUpdate:page-size":t[3]||(t[3]=t=>e.pageSize=t),total:e.total,"onUpdate:total":t[4]||(t[4]=t=>e.total=t),onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["layout","currentPage","page-size","total","onSizeChange","onCurrentChange"]),(0,s.Wm)(k,{class:"v-bottom-icon",size:20,onClick:t[5]||(t[5]=t=>e.executeLoad())},{default:(0,s.w5)((()=>[(0,s.Wm)(_)])),_:1})])])}var p=o(2482),g=o(4870),w=o(6520);function b(e,t=50){const o=e.clientWidth,a={};let l=0;if(0===o)return{};const n=e.querySelectorAll("tr");n.forEach((e=>{e.querySelectorAll("td, th").forEach((e=>{const o=e.querySelector(".cell"),l=e.querySelectorAll(".cell > *"),n=e.className.match(/mark_(\S+)/);let i=t;for(const t of l)i+=t.offsetWidth;if(n){const e=n[1];"operation"===e&&(i+=30),e in a?a[e]<i&&(a[e]=i):a[e]=o?.offsetWidth||0}}))}));for(const i in a)l+=a[i];if(l<o){let e=Object.keys(a).length;"selection"in a&&(e-=1),"operation"in a&&(e-=1);const t=(o-l)/e;for(const o in a)"selection"!==o&&"operation"!==o&&(a[o]+=t)}return a}var y=o(2748),v=function(e,t,o,a){var l,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(l=e[r])&&(i=(n<3?l(i):n>3?l(t,o,i):l(t,o))||i);return n>3&&i&&Object.defineProperty(t,o,i),i};let W=class extends w.w3{constructor(...e){super(...e),(0,p.Z)(this,"load",void 0),(0,p.Z)(this,"searchIcon",(0,g.XI)(y.olm)),(0,p.Z)(this,"searchInput",""),(0,p.Z)(this,"tableData",[]),(0,p.Z)(this,"columns",[]),(0,p.Z)(this,"colWidth",{}),(0,p.Z)(this,"pagination",!1),(0,p.Z)(this,"currentPage",1),(0,p.Z)(this,"pageSize",10),(0,p.Z)(this,"total",0)}getColumns(){return{columns:this.columns,colWidth:this.colWidth}}setData(e){this.tableData=e,this.total=e.length,this.pagination=!1}setPaginationData(e){this.tableData=e.list,this.total=e.total,this.pagination=!0}setColumns(e){const t=[];for(const o in e){const a=e[o];a.constructor===String?t.push({field:o,title:a}):(a.field||(a.field=o),t.push(a))}this.columns=t,this.executeLoad()}executeLoad(e=!1){e&&(this.currentPage=1),this.load({currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchInput})}handleSizeChange(){this.executeLoad()}handleCurrentChange(){this.executeLoad()}};W=v([(0,w.Ei)({components:{Refresh:y.hYj},props:{load:{type:Function,default:()=>null}},computed:{table(){return this.$refs.table}},methods:{resetWidth(){setTimeout((()=>{this.colWidth=b(this.table.$el)}),200)}},watch:{tableData:{handler(){this.resetWidth()},deep:!0}}})],W);var _=W,k=o(89);const V=(0,k.Z)(_,[["render",m]]);var Z=V},5860:function(e,t,o){o.d(t,{Z:function(){return m}});var a=o(7947),l=(o(9910),o(1955)),n=(o(2064),o(3396));function i(e,t,o,i,r,s){const d=l.ly,c=a.d0;return(0,n.wg)(),(0,n.j4)(c,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialogVisible=t),title:e.title,"append-to-body":e.appendToBody,width:e.width},{footer:(0,n.w5)((()=>[(0,n.WI)(e.$slots,"footer")])),default:(0,n.w5)((()=>[(0,n.Wm)(d,{model:e.form,"label-width":e.labelWidth},{default:(0,n.w5)((()=>[(0,n.WI)(e.$slots,"default")])),_:3},8,["model","label-width"])])),_:3},8,["modelValue","title","append-to-body","width"])}var r=o(2482),s=o(6520),d=function(e,t,o,a){var l,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(l=e[r])&&(i=(n<3?l(i):n>3?l(t,o,i):l(t,o))||i);return n>3&&i&&Object.defineProperty(t,o,i),i};let c=class extends s.w3{constructor(...e){super(...e),(0,r.Z)(this,"form",void 0),(0,r.Z)(this,"title",void 0),(0,r.Z)(this,"dialogVisible",!1)}show(){this.dialogVisible=!0}async asyncShow(){this.dialogVisible=!0,await this.$nextTick()}hide(){this.dialogVisible=!1}async asyncHide(){this.dialogVisible=!1,await this.$nextTick()}};c=d([(0,s.Ei)({props:{form:Object,title:String,width:Number,appendToBody:Boolean,labelWidth:{type:String,default:()=>"100px"}}})],c);var u=c,f=o(89);const h=(0,f.Z)(u,[["render",i]]);var m=h},9380:function(e,t,o){o.r(t),o.d(t,{default:function(){return D}});var a=o(5860),l=o(2261),n=(o(6809),o(8631)),i=(o(7029),o(9667)),r=(o(9112),o(1955)),s=(o(7113),o(3417)),d=(o(172),o(8288)),c=o(9971),u=(o(1430),o(5065)),f=(o(3189),o(3396)),h=o(7139);const m=(0,f.Uk)("编辑"),p=(0,f.Uk)("保存");function g(e,t,o,g,w,b){const y=u.E2,v=c.Ks,W=d.Z,_=s.EZ,k=r.nH,V=i.d6,Z=n.OX,C=l.mi,x=a.Z;return(0,f.wg)(),(0,f.iD)("div",null,[(0,f.Wm)(W,{ref:"table",load:e.loadList},{operations:(0,f.w5)((({row:t})=>[(0,f.Wm)(y,{underline:!1,type:"primary",onClick:o=>e.editUser(t)},{default:(0,f.w5)((()=>[m])),_:2},1032,["onClick"])])),cell:(0,f.w5)((({value:e,field:t})=>["black"===t?((0,f.wg)(),(0,f.j4)(v,{key:0,type:e?"danger":"info"},{default:(0,f.w5)((()=>[(0,f.Uk)((0,h.zw)(e?"是":"否"),1)])),_:2},1032,["type"])):(0,f.kq)("",!0)])),_:1},8,["load"]),(0,f.Wm)(x,{title:"编辑用户",form:e.form,ref:"dialog"},{footer:(0,f.w5)((()=>[(0,f.Wm)(C,{type:"primary",onClick:e.submit},{default:(0,f.w5)((()=>[p])),_:1},8,["onClick"])])),default:(0,f.w5)((()=>[(0,f.Wm)(k,{label:"用户ID"},{default:(0,f.w5)((()=>[(0,f.Wm)(_,{modelValue:e.form.user_id,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.user_id=t),disabled:""},null,8,["modelValue"])])),_:1}),(0,f.Wm)(k,{label:"用户昵称"},{default:(0,f.w5)((()=>[(0,f.Wm)(_,{modelValue:e.form.nickname,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.nickname=t),disabled:""},null,8,["modelValue"])])),_:1}),(0,f.Wm)(k,{label:"寻访凭证数量"},{default:(0,f.w5)((()=>[(0,f.Wm)(V,{modelValue:e.form.coupon,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.coupon=t)},null,8,["modelValue"])])),_:1}),(0,f.Wm)(k,{label:"合成玉数量"},{default:(0,f.w5)((()=>[(0,f.Wm)(V,{modelValue:e.form.jade_point,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.jade_point=t)},null,8,["modelValue"])])),_:1}),(0,f.Wm)(k,{label:"黑名单用户"},{default:(0,f.w5)((()=>[(0,f.Wm)(Z,{modelValue:e.form.black,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.black=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["form"])])}var w=o(2482),b=o(6520),y=o(8199);const v=new y.Z;async function W(e){return await v.post({url:"/user/getUser",data:e})}async function _(e){return await v.post({url:"/user/editUser",data:e})}var k=o(8418),V=function(e,t,o,a){var l,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(l=e[r])&&(i=(n<3?l(i):n>3?l(t,o,i):l(t,o))||i);return n>3&&i&&Object.defineProperty(t,o,i),i};let Z=class extends b.w3{constructor(...e){super(...e),(0,w.Z)(this,"table",void 0),(0,w.Z)(this,"dialog",void 0),(0,w.Z)(this,"form",{})}async loadList(e){const t=await W(e);t&&this.table.setPaginationData(t.data)}async editUser(e){this.form=k.Z.deepCopy(e),this.dialog.show()}async submit(){const e=await _(this.form);e&&(this.dialog.hide(),this.table.executeLoad())}};Z=V([(0,b.Ei)({components:{VTable:d.Z,VFormDialog:a.Z},computed:{table(){return this.$refs.table},dialog(){return this.$refs.dialog}},mounted(){this.table.setColumns({user_id:"用户ID",nickname:"用户昵称",user_feeling:"信赖值",coupon:"寻访凭证数量",jade_point:"合成玉数量",message_num:"累计互动数",sign_times:"累计签到次数",sign_date:"最近签到日",black:"黑名单用户"})}})],Z);var C=Z,x=o(89);const j=(0,x.Z)(C,[["render",g]]);var D=j},88:function(e,t,o){o(1758)},9910:function(e,t,o){o(1758),o(7195)},9112:function(e,t,o){o(1758),o(172)},3189:function(e,t,o){o(1758)},7960:function(e,t,o){o(1758)},7195:function(e,t,o){o(1758)},6467:function(e,t,o){o(1758)},451:function(e,t,o){o(1758)},3877:function(e,t,o){o(1758),o(172),o(1430),o(7960),o(451),o(6467)},7029:function(e,t,o){o(1758)},9007:function(e,t,o){o(1758),o(88),o(1430)},6905:function(e,t,o){o(1758),o(88),o(1430),o(4566),o(451)},4566:function(e,t,o){o(1758),o(6467)}}]);
//# sourceMappingURL=380.f8169815.js.map