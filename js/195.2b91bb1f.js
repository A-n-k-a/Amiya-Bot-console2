"use strict";(self["webpackChunkamiyabot_console"]=self["webpackChunkamiyabot_console"]||[]).push([[195],{8288:function(e,t,a){a.d(t,{Z:function(){return S}});var i=a(1015),n=(a(8474),a(3191)),l=(a(1758),a(3877),a(4550)),o=(a(6905),a(9007),a(3417)),s=(a(172),a(2261)),r=(a(6809),a(3396));const c={class:"v-table"},d={class:"header-area"},u=["innerHTML"],p=["innerHTML"],h={class:"v-bottom"};function f(e,t,a,f,g,w){const m=s.mi,y=o.EZ,b=l.$Y,k=l.eI,v=n.R,W=(0,r.up)("Refresh"),_=i.gn;return(0,r.wg)(),(0,r.iD)("div",c,[(0,r._)("div",d,[(0,r._)("div",null,[(0,r.WI)(e.$slots,"header")]),(0,r.Wm)(y,{style:{width:"520px"},modelValue:e.searchInput,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchInput=t),placeholder:"输入任意值搜索...",onChange:t[1]||(t[1]=t=>e.executeLoad(!0))},{append:(0,r.w5)((()=>[(0,r.Wm)(m,{icon:e.searchIcon},null,8,["icon"])])),_:1},8,["modelValue"])]),(0,r.Wm)(k,{data:e.tableData,stripe:"","header-cell-class-name":"v-table-header",ref:"table","empty-text":"暂无数据","max-height":600},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.columns,((t,a)=>((0,r.wg)(),(0,r.j4)(b,{"show-overflow-tooltip":"",width:t.width||e.colWidth[t.field],"class-name":"mark_"+t.field,key:a,prop:t.field,label:t.title},{default:(0,r.w5)((a=>[(0,r.WI)(e.$slots,"cell",{row:a.row,field:t.field,value:a.row[t.field],index:a.$index},(()=>[t.format?((0,r.wg)(),(0,r.iD)("div",{key:0,innerHTML:t.format(a.row,a.row[t.field],a.$index)},null,8,u)):((0,r.wg)(),(0,r.iD)("div",{key:1,innerHTML:a.row[t.field]},null,8,p))]))])),_:2},1032,["width","class-name","prop","label"])))),128)),this.$slots.operations?((0,r.wg)(),(0,r.j4)(b,{key:0,label:"操作",fixed:"right","class-name":"mark_operation",width:e.colWidth.operation},{default:(0,r.w5)((t=>[(0,r.WI)(e.$slots,"operations",{row:t.row,index:t.$index})])),_:3},8,["width"])):(0,r.kq)("",!0)])),_:3},8,["data"]),(0,r._)("div",h,[(0,r.Wm)(v,{layout:e.pagination?"total, prev, pager, next, sizes, jumper":"total",small:!0,background:!0,currentPage:e.currentPage,"onUpdate:currentPage":t[2]||(t[2]=t=>e.currentPage=t),"page-size":e.pageSize,"onUpdate:page-size":t[3]||(t[3]=t=>e.pageSize=t),total:e.total,"onUpdate:total":t[4]||(t[4]=t=>e.total=t),onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["layout","currentPage","page-size","total","onSizeChange","onCurrentChange"]),(0,r.Wm)(_,{class:"v-bottom-icon",size:20,onClick:t[5]||(t[5]=t=>e.executeLoad())},{default:(0,r.w5)((()=>[(0,r.Wm)(W)])),_:1})])])}var g=a(2482),w=a(4870),m=a(6520);function y(e,t=50){const a=e.clientWidth,i={};let n=0;if(0===a)return{};const l=e.querySelectorAll("tr");l.forEach((e=>{e.querySelectorAll("td, th").forEach((e=>{const a=e.querySelector(".cell"),n=e.querySelectorAll(".cell > *"),l=e.className.match(/mark_(\S+)/);let o=t;for(const t of n)o+=t.offsetWidth;if(l){const e=l[1];"operation"===e&&(o+=30),e in i?i[e]<o&&(i[e]=o):i[e]=a?.offsetWidth||0}}))}));for(const o in i)n+=i[o];if(n<a){let e=Object.keys(i).length;"selection"in i&&(e-=1),"operation"in i&&(e-=1);const t=(a-n)/e;for(const a in i)"selection"!==a&&"operation"!==a&&(i[a]+=t)}return i}var b=a(2748),k=function(e,t,a,i){var n,l=arguments.length,o=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(l<3?n(o):l>3?n(t,a,o):n(t,a))||o);return l>3&&o&&Object.defineProperty(t,a,o),o};let v=class extends m.w3{constructor(...e){super(...e),(0,g.Z)(this,"load",void 0),(0,g.Z)(this,"searchIcon",(0,w.XI)(b.olm)),(0,g.Z)(this,"searchInput",""),(0,g.Z)(this,"tableData",[]),(0,g.Z)(this,"columns",[]),(0,g.Z)(this,"colWidth",{}),(0,g.Z)(this,"pagination",!1),(0,g.Z)(this,"currentPage",1),(0,g.Z)(this,"pageSize",10),(0,g.Z)(this,"total",0)}getColumns(){return{columns:this.columns,colWidth:this.colWidth}}setData(e){this.tableData=e,this.total=e.length,this.pagination=!1}setPaginationData(e){this.tableData=e.list,this.total=e.total,this.pagination=!0}setColumns(e){const t=[];for(const a in e){const i=e[a];i.constructor===String?t.push({field:a,title:i}):(i.field||(i.field=a),t.push(i))}this.columns=t,this.executeLoad()}executeLoad(e=!1){e&&(this.currentPage=1),this.load({currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchInput})}handleSizeChange(){this.executeLoad()}handleCurrentChange(){this.executeLoad()}};v=k([(0,m.Ei)({components:{Refresh:b.hYj},props:{load:{type:Function,default:()=>null}},computed:{table(){return this.$refs.table}},methods:{resetWidth(){setTimeout((()=>{this.colWidth=y(this.table.$el)}),200)}},watch:{tableData:{handler(){this.resetWidth()},deep:!0}}})],v);var W=v,_=a(89);const C=(0,_.Z)(W,[["render",f]]);var S=C},5860:function(e,t,a){a.d(t,{Z:function(){return f}});var i=a(7947),n=(a(9910),a(1955)),l=(a(2064),a(3396));function o(e,t,a,o,s,r){const c=n.ly,d=i.d0;return(0,l.wg)(),(0,l.j4)(d,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialogVisible=t),title:e.title,"append-to-body":e.appendToBody,width:e.width},{footer:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"footer")])),default:(0,l.w5)((()=>[(0,l.Wm)(c,{model:e.form,"label-width":e.labelWidth},{default:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"default")])),_:3},8,["model","label-width"])])),_:3},8,["modelValue","title","append-to-body","width"])}var s=a(2482),r=a(6520),c=function(e,t,a,i){var n,l=arguments.length,o=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(l<3?n(o):l>3?n(t,a,o):n(t,a))||o);return l>3&&o&&Object.defineProperty(t,a,o),o};let d=class extends r.w3{constructor(...e){super(...e),(0,s.Z)(this,"form",void 0),(0,s.Z)(this,"title",void 0),(0,s.Z)(this,"dialogVisible",!1)}show(){this.dialogVisible=!0}async asyncShow(){this.dialogVisible=!0,await this.$nextTick()}hide(){this.dialogVisible=!1}async asyncHide(){this.dialogVisible=!1,await this.$nextTick()}};d=c([(0,r.Ei)({props:{form:Object,title:String,width:Number,appendToBody:Boolean,labelWidth:{type:String,default:()=>"100px"}}})],d);var u=d,p=a(89);const h=(0,p.Z)(u,[["render",o]]);var f=h},3195:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var i=a(5860),n=a(1955),l=(a(7113),a(3417)),o=(a(172),a(8288)),s=a(5065),r=(a(3189),a(9971)),c=(a(1430),a(2261)),d=(a(6809),a(3396)),u=a(7139),p=a(9242);const h=(0,d.Uk)("添加词语替换"),f=(0,d.Uk)("同步词语替换"),g=(0,d.Uk)("黑名单设置"),w=(0,d.Uk)("白名单设置"),m=(0,d.Uk)(" 设为全局启用 "),y=(0,d.Uk)(" 关闭全局启用 "),b=(0,d.Uk)("删除"),k=(0,d.Uk)("保存"),v={class:"setting-word"},W=(0,d.Uk)(" + 添加词语 ");function _(e,t,a,_,C,S){const Z=c.mi,R=r.Ks,V=s.E2,x=o.Z,j=l.EZ,D=n.nH,L=i.Z;return(0,d.wg)(),(0,d.iD)("div",null,[(0,d.Wm)(x,{ref:"table",load:e.loadList},{header:(0,d.w5)((()=>[(0,d.Wm)(Z,{type:"primary",onClick:t[0]||(t[0]=t=>e.$refs.dialog.show())},{default:(0,d.w5)((()=>[h])),_:1}),(0,d.Wm)(Z,{type:"warning",onClick:e.syncReplace},{default:(0,d.w5)((()=>[f])),_:1},8,["onClick"]),(0,d.Wm)(Z,{onClick:t[1]||(t[1]=t=>e.wordSetting(1))},{default:(0,d.w5)((()=>[g])),_:1}),(0,d.Wm)(Z,{onClick:t[2]||(t[2]=t=>e.wordSetting(0))},{default:(0,d.w5)((()=>[w])),_:1})])),cell:(0,d.w5)((({value:e,field:t})=>["is_global"===t?((0,d.wg)(),(0,d.j4)(R,{key:0,type:e?"success":"info"},{default:(0,d.w5)((()=>[(0,d.Uk)((0,u.zw)(e?"是":"否"),1)])),_:2},1032,["type"])):(0,d.kq)("",!0),"is_active"===t?((0,d.wg)(),(0,d.j4)(R,{key:1,type:e?"success":"danger"},{default:(0,d.w5)((()=>[(0,d.Uk)((0,u.zw)(e?"是":"否"),1)])),_:2},1032,["type"])):(0,d.kq)("",!0)])),operations:(0,d.w5)((({row:t})=>[0===t.is_global?((0,d.wg)(),(0,d.j4)(V,{key:0,underline:!1,type:"success",onClick:a=>e.updateReplace(t,1)},{default:(0,d.w5)((()=>[m])),_:2},1032,["onClick"])):((0,d.wg)(),(0,d.j4)(V,{key:1,underline:!1,type:"warning",onClick:a=>e.updateReplace(t,0)},{default:(0,d.w5)((()=>[y])),_:2},1032,["onClick"])),(0,d.Wm)(V,{underline:!1,type:"danger",onClick:a=>e.delReplace(t)},{default:(0,d.w5)((()=>[b])),_:2},1032,["onClick"])])),_:1},8,["load"]),(0,d.Wm)(L,{title:"添加词语替换",form:e.form,ref:"dialog"},{footer:(0,d.w5)((()=>[(0,d.Wm)(Z,{type:"primary",onClick:e.submit},{default:(0,d.w5)((()=>[k])),_:1},8,["onClick"])])),default:(0,d.w5)((()=>[(0,d.Wm)(D,{label:"被替换词语"},{default:(0,d.w5)((()=>[(0,d.Wm)(j,{modelValue:e.form.origin,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.origin=t)},null,8,["modelValue"])])),_:1}),(0,d.Wm)(D,{label:"替换词语"},{default:(0,d.w5)((()=>[(0,d.Wm)(j,{modelValue:e.form.replace,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.replace=t)},null,8,["modelValue"])])),_:1})])),_:1},8,["form"]),(0,d.Wm)(L,{title:"审核词设置："+(e.settingMode?"黑名单":"白名单"),ref:"setting"},{default:(0,d.w5)((()=>[(0,d._)("div",v,[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.settingWord,((t,a)=>((0,d.wg)(),(0,d.iD)(d.HY,null,[t.status===e.settingMode?((0,d.wg)(),(0,d.j4)(R,{class:"tag",closable:"",key:a,"disable-transitions":!1,onClose:a=>e.delReplaceSetting(t)},{default:(0,d.w5)((()=>[(0,d.Uk)((0,u.zw)(t.text),1)])),_:2},1032,["onClose"])):(0,d.kq)("",!0)],64)))),256)),(0,d.wy)((0,d.Wm)(j,{class:"add",size:"small",ref:"tagInput",modelValue:e.inputValue,"onUpdate:modelValue":t[5]||(t[5]=t=>e.inputValue=t),onKeyup:(0,p.D2)(e.addSetting,["enter"]),onBlur:e.cancelAddSetting},null,8,["modelValue","onKeyup","onBlur"]),[[p.F8,e.inputMode]]),(0,d.wy)((0,d.Wm)(Z,{class:"add",size:"small",onClick:t[6]||(t[6]=t=>e.inputMode=!0)},{default:(0,d.w5)((()=>[W])),_:1},512),[[p.F8,!e.inputMode]])])])),_:1},8,["title"])])}var C=a(2482),S=a(6520),Z=a(8199);const R=new Z.Z;async function V(e){return await R.post({url:"/replace/getReplace",data:e})}async function x(e){return await R.post({url:"/replace/updateReplace",data:e})}async function j(e){return await R.post({url:"/replace/addReplace",data:e})}async function D(e){return await R.post({url:"/replace/deleteReplace",data:e})}async function L(){return await R.get({url:"/replace/getReplaceSetting"})}async function U(e){return await R.post({url:"/replace/addReplaceSetting",data:e})}async function z(e){return await R.post({url:"/replace/deleteReplaceSetting",data:e})}async function $(){return await R.get({url:"/replace/syncReplace"})}var P=a(8418),I=a(9037),M=function(e,t,a,i){var n,l=arguments.length,o=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(l<3?n(o):l>3?n(t,a,o):n(t,a))||o);return l>3&&o&&Object.defineProperty(t,a,o),o};let O=class extends S.w3{constructor(...e){super(...e),(0,C.Z)(this,"table",void 0),(0,C.Z)(this,"dialog",void 0),(0,C.Z)(this,"setting",void 0),(0,C.Z)(this,"form",{origin:"",replace:""}),(0,C.Z)(this,"settingWord",[]),(0,C.Z)(this,"settingMode",0),(0,C.Z)(this,"inputMode",!1),(0,C.Z)(this,"inputValue","")}async loadList(e){const t=await V(e);t&&this.table.setPaginationData(t.data)}async updateReplace(e,t){const a={...e,is_global:t},i=await x(a);i&&this.table.executeLoad()}async delReplace(e){const t=await D(e);t&&this.table.executeLoad()}async submit(){const e=await j(this.form);e&&(this.dialog.hide(),this.table.executeLoad(),this.form={origin:"",replace:""})}async getReplaceSettingList(){const e=await L();e&&(this.settingWord=e.data)}async addSetting(){const e={text:this.inputValue,status:this.settingMode},t=await U(e);t&&(this.settingWord=t.data),this.cancelAddSetting(),await this.getReplaceSettingList()}async delReplaceSetting(e){const t=await z(e);t&&await this.getReplaceSettingList()}async wordSetting(e){await this.getReplaceSettingList(),this.settingMode=e,this.setting.show()}async syncReplace(){if(await I.Z.confirm("同步词语替换将会强制覆盖本地所有词语替换配置，造成自定义的词语替换丢失，是否开始同步？","警告")){const e=await $();e&&this.table.executeLoad(!0)}}cancelAddSetting(){this.inputMode=!1,this.inputValue=""}};O=M([(0,S.Ei)({components:{VTable:o.Z,VFormDialog:i.Z},computed:{table(){return this.$refs.table},dialog(){return this.$refs.dialog},setting(){return this.$refs.setting}},watch:{inputMode(e){e&&this.$refs.tagInput.focus()}},mounted(){this.table.setColumns({user_id:{title:"添加用户",format:(e,t)=>"0"===t?"无":t},group_id:{title:"所在群组",format:(e,t)=>"0"===t?"无":t},origin:"被替换词语",replace:"替换词语",in_time:{title:"添加时间",format:(e,t)=>P.Z.formatDate(t)},is_active:"是否启用",is_global:"是否全局启用"})}})],O);var T=O,H=a(89);const q=(0,H.Z)(T,[["render",_],["__scopeId","data-v-5647cb02"]]);var E=q},88:function(e,t,a){a(1758)},9910:function(e,t,a){a(1758),a(7195)},3189:function(e,t,a){a(1758)},7960:function(e,t,a){a(1758)},7195:function(e,t,a){a(1758)},6467:function(e,t,a){a(1758)},451:function(e,t,a){a(1758)},3877:function(e,t,a){a(1758),a(172),a(1430),a(7960),a(451),a(6467)},9007:function(e,t,a){a(1758),a(88),a(1430)},6905:function(e,t,a){a(1758),a(88),a(1430),a(4566),a(451)},4566:function(e,t,a){a(1758),a(6467)}}]);
//# sourceMappingURL=195.2b91bb1f.js.map